<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #f1f5f9;
            min-height: 100vh;
            padding: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 600px;
            width: 100%;
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 20px;
            padding: 2.5rem;
        }

        h1 {
            text-align: center;
            color: #3b82f6;
            margin-bottom: 2rem;
        }

        .info-box {
            background: rgba(15, 23, 42, 0.5);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            border: 2px solid rgba(59, 130, 246, 0.2);
        }

        .info-box h3 {
            color: #60a5fa;
            margin-bottom: 1rem;
        }

        .info-box p {
            color: #94a3b8;
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        .info-box code {
            background: rgba(59, 130, 246, 0.2);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            color: #60a5fa;
            font-family: 'Courier New', monospace;
        }

        .btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result {
            background: rgba(15, 23, 42, 0.5);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1.5rem;
            border: 2px solid rgba(59, 130, 246, 0.2);
            display: none;
        }

        .result.show {
            display: block;
        }

        .result.success {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .result.error {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .result h3 {
            margin-bottom: 1rem;
        }

        .result.success h3 {
            color: #10b981;
        }

        .result.error h3 {
            color: #ef4444;
        }

        .result pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            color: #94a3b8;
            font-size: 0.875rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .loading {
            text-align: center;
            color: #60a5fa;
            display: none;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid rgba(59, 130, 246, 0.2);
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google</h1>

        <div class="info-box">
            <h3>ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
            <p><strong>Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ:</strong> <code id="currentDomain"></code></p>
            <p><strong>Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„:</strong> <code id="currentProtocol"></code></p>
            <p><strong>Auth Domain:</strong> <code>a-platform-for-learning.firebaseapp.com</code></p>
        </div>

        <div class="info-box">
            <h3>âœ… Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡</h3>
            <p>1. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† ÙÙŠ Firebase Console</p>
            <p>2. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† ÙÙŠ Google Cloud Console</p>
            <p>3. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… HTTPS (ÙˆÙ„ÙŠØ³ HTTP)</p>
            <p>4. Ø§Ù…Ø³Ø­ Ø§Ù„Ù€ Cache Ø£Ùˆ Ø¬Ø±Ø¨ ÙÙŠ Incognito</p>
        </div>

        <button class="btn" id="testGoogleBtn">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google</button>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google...</p>
        </div>

        <div class="result" id="result"></div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        // Display current domain info
        document.getElementById('currentDomain').textContent = window.location.hostname;
        document.getElementById('currentProtocol').textContent = window.location.protocol;

        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyAU0CCiQNrPEYpTNU4rAwmOmPUZnjb2FoU",
            authDomain: "a-platform-for-learning.firebaseapp.com",
            projectId: "a-platform-for-learning",
            storageBucket: "a-platform-for-learning.firebasestorage.app",
            messagingSenderId: "764579707883",
            appId: "1:764579707883:web:5456e2348354cc58fab7ae",
            measurementId: "G-4P972FP416"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();

        // Test Google Sign-In
        document.getElementById('testGoogleBtn').addEventListener('click', async function() {
            const btn = this;
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');

            // Reset
            btn.disabled = true;
            loading.classList.add('show');
            result.classList.remove('show', 'success', 'error');
            result.innerHTML = '';

            try {
                console.log('ğŸ”µ Starting Google Sign-In test...');
                console.log('Current domain:', window.location.hostname);
                console.log('Auth domain:', firebaseConfig.authDomain);

                const userCredential = await signInWithPopup(auth, googleProvider);
                const user = userCredential.user;

                console.log('âœ… Sign-In successful!', user);

                // Show success
                loading.classList.remove('show');
                result.classList.add('show', 'success');
                result.innerHTML = `
                    <h3>âœ… Ù†Ø¬Ø­ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„!</h3>
                    <p style="color: #94a3b8; margin-bottom: 1rem;">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</p>
                    <pre>${JSON.stringify({
                        name: user.displayName,
                        email: user.email,
                        uid: user.uid,
                        photoURL: user.photoURL
                    }, null, 2)}</pre>
                    <p style="color: #10b981; margin-top: 1rem;">ğŸ‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!</p>
                `;

                btn.disabled = false;

            } catch (error) {
                console.error('âŒ Sign-In failed:', error);

                // Show error
                loading.classList.remove('show');
                result.classList.add('show', 'error');

                let errorMessage = '';
                let solution = '';

                switch (error.code) {
                    case 'auth/popup-closed-by-user':
                        errorMessage = 'ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©';
                        solution = 'Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ÙˆÙ„Ø§ ØªØºÙ„Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©';
                        break;

                    case 'auth/popup-blocked':
                        errorMessage = 'ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©';
                        solution = 'Ø§Ø³Ù…Ø­ Ø¨Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­';
                        break;

                    case 'auth/unauthorized-domain':
                        errorMessage = 'Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ù‡';
                        solution = `
                            <strong>Ø§Ù„Ø­Ù„:</strong><br>
                            1. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Firebase Console<br>
                            2. Authentication > Settings > Authorized domains<br>
                            3. Ø£Ø¶Ù: <code>${window.location.hostname}</code>
                        `;
                        break;

                    case 'auth/operation-not-allowed':
                        errorMessage = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„';
                        solution = `
                            <strong>Ø§Ù„Ø­Ù„:</strong><br>
                            1. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Firebase Console<br>
                            2. Authentication > Sign-in method<br>
                            3. ÙØ¹Ù‘Ù„ Google Sign-In
                        `;
                        break;

                    default:
                        errorMessage = error.message;
                        solution = `
                            <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø­ØªÙ…Ù„:</strong><br>
                            1. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† ÙÙŠ Firebase Console<br>
                            2. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† ÙÙŠ Google Cloud Console<br>
                            3. Ø§Ù…Ø³Ø­ Ø§Ù„Ù€ Cache ÙˆØ¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰<br>
                            4. Ø§Ù†ØªØ¸Ø± 5-10 Ø¯Ù‚Ø§Ø¦Ù‚ Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                        `;
                }

                result.innerHTML = `
                    <h3>âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
                    <p style="color: #94a3b8; margin-bottom: 1rem;"><strong>Ø§Ù„Ø®Ø·Ø£:</strong> ${errorMessage}</p>
                    <pre>${JSON.stringify({
                        code: error.code,
                        message: error.message,
                        currentDomain: window.location.hostname,
                        authDomain: firebaseConfig.authDomain
                    }, null, 2)}</pre>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 8px;">
                        ${solution}
                    </div>
                `;

                btn.disabled = false;
            }
        });
    </script>
</body>
</html>
